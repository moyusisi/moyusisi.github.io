import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as e,c as a,d as n}from"./app-DeOdKxsU.js";const l={},o=n(`<p>Nginx的location模块主要用于配置server中的URL匹配</p><h2 id="匹配规则" tabindex="-1"><a class="header-anchor" href="#匹配规则"><span>匹配规则</span></a></h2><h3 id="基础匹配" tabindex="-1"><a class="header-anchor" href="#基础匹配"><span>基础匹配</span></a></h3><p><code>location / { ... }</code>：这是最基本的匹配，匹配所有请求。因为它没有指定具体的文件或目录，所以通常作为后备选项出现。</p><h3 id="精确匹配" tabindex="-1"><a class="header-anchor" href="#精确匹配"><span>精确匹配</span></a></h3><p><code>location = /exact/path { ... }</code>：精确匹配这个路径。如果请求的 URI 完全等于/exact/path，则使用这个location块的配置处理此请求。</p><h3 id="前缀匹配" tabindex="-1"><a class="header-anchor" href="#前缀匹配"><span>前缀匹配</span></a></h3><ul><li><code>location /prefix/ { ... }</code>：前缀匹配请求的 URI 的开始部分。如果请求的 URI 以/prefix/开始，这个location块将被用来处理请求。</li><li><code>location ^~ /prefix/ { ... }</code>：前缀匹配，但它会阻断正则表达式匹配，即使正则表达式可能会更具体匹配。如果该location匹配，Nginx 不会考虑之后的正则location块。</li></ul><h3 id="正则表达式匹配" tabindex="-1"><a class="header-anchor" href="#正则表达式匹配"><span>正则表达式匹配</span></a></h3><p>正则表达式匹配会在普通字符串前缀匹配后进行。如果有多个正则表达式location都匹配请求，则使用第一个匹配的location块。</p><ul><li><code>location ~ /regex/ { ... }</code>：大小写敏感的正则匹配。</li><li><code>location ~* /regex/ { ... }</code>：大小写不敏感的正则匹配。</li></ul><h2 id="优先级顺序" tabindex="-1"><a class="header-anchor" href="#优先级顺序"><span>优先级顺序</span></a></h2><p>Nginx 处理请求时 location 匹配的优先级顺序如下：</p><ul><li>先进行精确匹配<code>location =</code></li><li>其次按文件中出现顺序匹配所有正则表达式<code>location ~</code>和<code>location ~*</code></li><li>然后进行最长的前缀匹配<code>location ^~</code></li><li>最后是通常的前缀匹配<code>location /prefix/</code></li><li>如果前面的匹配都没有找到，就使用默认的location /</li></ul><h2 id="proxy-pass" tabindex="-1"><a class="header-anchor" href="#proxy-pass"><span>proxy_pass</span></a></h2><p><code>proxy_pass</code>是<code>nginx</code>中用于反向代理的核心指令，它允许nginx将客户端的请求转发到后端服务器，并将响应返回给客户端。</p><p><code>proxy_pass</code>的使用方式有两种，分别为<code>请求转发</code>和<code>路径替换</code></p><h3 id="请求转发" tabindex="-1"><a class="header-anchor" href="#请求转发"><span>请求转发</span></a></h3><p><code>proxy_pass</code>中仅包含<code>协议://主机名:端口</code>，除此之外不包含任何路径(如<code>/</code>)，此时会将匹配到的请求转发。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#24292e;color:#e1e4e8;"><pre class="shiki github-dark vp-code"><code><span class="line"><span style="color:#6A737D;">  # 请求路径为：http://127.0.0.1:8080/api/getUser</span></span>
<span class="line"><span style="color:#6A737D;">  # 实际访问为：http://127.0.0.1:8000/api/getUser</span></span>
<span class="line"><span style="color:#B392F0;">  location</span><span style="color:#9ECBFF;"> ^~/api/</span><span style="color:#9ECBFF;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    proxy_pass</span><span style="color:#9ECBFF;"> http://127.0.0.1:8000</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">    proxy_set_header</span><span style="color:#9ECBFF;"> Host</span><span style="color:#E1E4E8;"> $http_host;           </span><span style="color:#6A737D;"># 后台可以获取到完整的ip+端口号</span></span>
<span class="line"><span style="color:#B392F0;">    proxy_set_header</span><span style="color:#9ECBFF;"> X-Real-IP</span><span style="color:#E1E4E8;"> $remote_addr;    </span><span style="color:#6A737D;"># 后台可以获取到用户访问的真实ip地址</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路径替换" tabindex="-1"><a class="header-anchor" href="#路径替换"><span>路径替换</span></a></h3><p><code>proxy_pass</code>中包含<code>协议://主机名:端口</code>之外，还包含路径(如<code>/</code>、<code>/api</code>)，此时会将匹配到的请求转发之外，还会将匹配路径进行替换改写。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#24292e;color:#e1e4e8;"><pre class="shiki github-dark vp-code"><code><span class="line"><span style="color:#6A737D;">  # 请求路径为：http://127.0.0.1:8080/api/getUser</span></span>
<span class="line"><span style="color:#6A737D;">  # 实际访问为：http://127.0.0.1:8000/user/getUser</span></span>
<span class="line"><span style="color:#B392F0;">  location</span><span style="color:#9ECBFF;"> ^~/api</span><span style="color:#9ECBFF;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    proxy_pass</span><span style="color:#9ECBFF;"> http://127.0.0.1:8000/user</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="root和alias" tabindex="-1"><a class="header-anchor" href="#root和alias"><span>root和alias</span></a></h2><p><code>root</code>和<code>alias</code>都是Nginx中用于指定静态资源路径的指令，但它们在处理请求路径时有所不同。</p><ul><li><code>root</code>指令会将请求路径拼接到<code>root</code>指令指定的路径后面，有些像请求转发。</li><li><code>alias</code>指令会将请求匹配路径替换为<code>alias</code>指令指定的路径，有些像路径替换。</li></ul><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#24292e;color:#e1e4e8;"><pre class="shiki github-dark vp-code"><code><span class="line"><span style="color:#B392F0;">server</span><span style="color:#9ECBFF;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  listen</span><span style="color:#79B8FF;"> 80</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">  server_name</span><span style="color:#9ECBFF;"> localhost</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">  # 用root方式，location中的路径会拼加到root的地址后面</span></span>
<span class="line"><span style="color:#6A737D;">  # 请求路径为：http://localhost:8080/files/index.jpg    </span></span>
<span class="line"><span style="color:#6A737D;">  # 实际访问为：http://localhost:8080/home/files/index.jpg</span></span>
<span class="line"><span style="color:#B392F0;">  location</span><span style="color:#9ECBFF;"> ~^/files/</span><span style="color:#9ECBFF;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    root</span><span style="color:#9ECBFF;"> /home/</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">    index</span><span style="color:#9ECBFF;"> index.html</span><span style="color:#9ECBFF;"> index.htm</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#6A737D;">  # 用alias方式，location中的路径不会拼加到alias的地址后面</span></span>
<span class="line"><span style="color:#6A737D;">  # 请求路径为：http://localhost:8080/files/index.jpg    </span></span>
<span class="line"><span style="color:#6A737D;">  # 实际访问为：http://localhost:8080/home/index.jpg</span></span>
<span class="line"><span style="color:#B392F0;">  location</span><span style="color:#9ECBFF;"> ~^/files/</span><span style="color:#9ECBFF;"> {</span></span>
<span class="line"><span style="color:#79B8FF;">    alias</span><span style="color:#9ECBFF;"> /home/</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">    index</span><span style="color:#9ECBFF;"> index.html</span><span style="color:#9ECBFF;"> index.htm</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,27),i=[o];function t(c,p){return e(),a("div",null,i)}const h=s(l,[["render",t],["__file","2025-12-06-Nginx的location模块.html.vue"]]),y=JSON.parse('{"path":"/program/linux/2025-12-06-Nginx%E7%9A%84location%E6%A8%A1%E5%9D%97.html","title":"Nginx的location模块","lang":"zh-CN","frontmatter":{"title":"Nginx的location模块","date":"2025-12-06T00:00:00.000Z","category":"Web","tag":["Nginx"],"order":-20251206,"description":"Nginx的location模块主要用于配置server中的URL匹配 匹配规则 基础匹配 location / { ... }：这是最基本的匹配，匹配所有请求。因为它没有指定具体的文件或目录，所以通常作为后备选项出现。 精确匹配 location = /exact/path { ... }：精确匹配这个路径。如果请求的 URI 完全等于/exact/...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/program/linux/2025-12-06-Nginx%E7%9A%84location%E6%A8%A1%E5%9D%97.html"}],["meta",{"property":"og:site_name","content":"魔芋丝丝"}],["meta",{"property":"og:title","content":"Nginx的location模块"}],["meta",{"property":"og:description","content":"Nginx的location模块主要用于配置server中的URL匹配 匹配规则 基础匹配 location / { ... }：这是最基本的匹配，匹配所有请求。因为它没有指定具体的文件或目录，所以通常作为后备选项出现。 精确匹配 location = /exact/path { ... }：精确匹配这个路径。如果请求的 URI 完全等于/exact/..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-04T10:59:08.000Z"}],["meta",{"property":"article:author","content":"moyusisi"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:published_time","content":"2025-12-06T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-04T10:59:08.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx的location模块\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-12-06T00:00:00.000Z\\",\\"dateModified\\":\\"2025-12-04T10:59:08.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"moyusisi\\"}]}"]]},"headers":[{"level":2,"title":"匹配规则","slug":"匹配规则","link":"#匹配规则","children":[{"level":3,"title":"基础匹配","slug":"基础匹配","link":"#基础匹配","children":[]},{"level":3,"title":"精确匹配","slug":"精确匹配","link":"#精确匹配","children":[]},{"level":3,"title":"前缀匹配","slug":"前缀匹配","link":"#前缀匹配","children":[]},{"level":3,"title":"正则表达式匹配","slug":"正则表达式匹配","link":"#正则表达式匹配","children":[]}]},{"level":2,"title":"优先级顺序","slug":"优先级顺序","link":"#优先级顺序","children":[]},{"level":2,"title":"proxy_pass","slug":"proxy-pass","link":"#proxy-pass","children":[{"level":3,"title":"请求转发","slug":"请求转发","link":"#请求转发","children":[]},{"level":3,"title":"路径替换","slug":"路径替换","link":"#路径替换","children":[]}]},{"level":2,"title":"root和alias","slug":"root和alias","link":"#root和alias","children":[]}],"git":{"createdTime":1764845948000,"updatedTime":1764845948000,"contributors":[{"name":"moyusisi","email":"moyusisi@126.com","commits":1}]},"filePathRelative":"program/linux/2025-12-06-Nginx的location模块.md","localizedDate":"2025年12月6日","excerpt":"","autoDesc":true}');export{h as comp,y as data};
